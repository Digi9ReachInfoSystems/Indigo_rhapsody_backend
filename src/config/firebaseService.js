const admin = require("firebase-admin");

if (!admin.apps.length) {
  const decodedServiceAccount = JSON.parse(
    Buffer.from(
      "ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAic3ZlY2NoYS0xMWMzMSIsCiAgInByaXZhdGVfa2V5X2lkIjogImQ5NGNhNzQ3NGNmZjIxYWU5ODE4MmQ5M2QxYzE5YjkyZTNiZmQxODMiLAogICJwcml2YXRlX2tleSI6ICItLS0tLUJFR0lOIFBSSVZBVEUgS0VZLS0tLS1cbk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktjd2dnU2pBZ0VBQW9JQkFRQzlQUE9SWU1mdjJjNStcbjA4UEZVTlBZR2pPY2Z1UHA5K1Q0d05ybTVxMXYrVkpUVG44eGpiMnRJQ1FYeUo3VjFMUGNUOGNhZUdnb3Bwem5cbkRNUFR0K20yNnBvY0xsZ0xNTWV4dGNReEk1UXNIY1crMy9EWEllVCtkSVk2ajNXZ0dQWnV3SDMvODVUeXpaSVhcblZCMTJGRFJMa0FoeTVpaWpPTDU2ZlFMdEI4SnhGUkI3VXVFVnRxSU1wMmlXR1R5UHc3c3BKdUFxVUF3UDV6WXZcblRFV1hnVmliTUFmMDRIbmo1L1R2Z3ZXRnU4RFpWRENZblJ3bmpCUkNKZ2pxZXE3TVoxSWRXelZzV1NYaFBMMkNcbkd5Q3dQS0JSeHQwVVloOVRHOTVQZ1IzUlh2UFR3anVsRkR3SHptczFEVkh3SW5CNC9icXEwOHh4Y0hmaHcrZE5cbkFPRHk5SzliQWdNQkFBRUNnZ0VBTHk5RWVDcE9rQktaOTJ1cjg4WWNuRlNrSzlCRDJmSFNxT2ZGYlM5MWJXY1lcblRPZFV0YkZtNndVSm10aU9LamtZQThYc21rQU5rSjFDb0NYQnFrZkFRYmlyWm4xenZJNlVMRTVyTmVsdUo3WGdcbnVhQXkrQ0ZlYk1mM05DRFRMbkVxK1NDTUNrYmRDOUdRTExydmdhSzJDMlZGaGdpM2QwTk4wMUxhYU9tM1pPUnhcbnQvNTE4REVMZk9aMENXS3U1QTUvd3BaaXUrM0U2Y1RJdXRlc2MxUHd1MldDa0F0Tlh2OXVFVFEzOThacDZ6c25cblp0RkxnN3d3UHZHeUR6ZjdhV2xBbFE5Zlc0ekdIc0hTN3VGRHJqeHNhY0MweE5UU01WaitGSXhBVmgvd05rZUlcbjBuS09FRStDRHhlaWl1YTJoTWVCU3pVWjBZSjVoWGxsOXMrR3JBTUk0UUtCZ1FEL1NLZHpjQm9Mb2V5aXFzOS9cbktnV2FabzRveDlqL2Rpci9ydzV1RTNkaEZsTjBzMFJNN2dDTy9lK1Y0TXFQZEtjeG5Fd1JrbUp5RVd4b0oxOFlcbmFBUXRRVjlCT0JqWkNQUFBZTWFEeUcxeVdBb09BZGVUL3AvZ2hOQzFSMlhnU3h2ZGlEbjB1bHdqb1RtaFRsdk5cbmJlVGtteVY0RDNlU3RROE5DM0ZQTm5lakN3S0JnUUM5eE56dkxnaFFFN0NIU2RwbGU3ZFU3VXpURzlXVXZ3NS9cbnl2cHhEekhtRzlFSHFacVdPMjdvdXVtQTAwTEpjRUI3akI3ZmpDREFUR3g0Nkt5cFY0dmNQZkh6MEV5ZWNQdS9cbmd6R1RIendBZm5tRHhjeWZvWEwyQTAwZVNwVmpOVTlqUkdOVlYycXhBRUhFREsxd2J4L3lpL2hCOHlWQzI5cmFcbkNKTlNVN3ZXOFFLQmdEaUhMZzB4MVpLZDJIaHN1bVcrT0Y5b05qSnhqbXVERHlKdThSTU8zSEJ6TVNlMlNubCtcbmVrRXZtYzNtYVBRN01JcWJ3WHhpbmNvRWNhemVpd0FzaUVBOUtZcVhrV2o5d244NVByd1B0YXlNTWkzSDJxUzZcbnpVdzZITDBIZ2xlWVNpTlQ5d0ZxQXQwZzVsSUJ0L0pWVTBvTDBOQTFISlV2NHBWUTQxWlhDVWJoQW9HQVhJcGVcbnp3aGNwMmdpb3FiQ0tORCs0eHhoWldWaWJ3b0ljUXN6dStTVUNjbXcwcExEdnRVMnpha3dhMUVhZFk4Vzh1aXVcbnVZYmxCY0YrK0N0RzM4SEFnMk4xMU5iVU5rT1VrSnpTbFJNYk9JWjBqV3pzeno5MUIwRXUzMEd4dmRKbVoxc1hcbk1hdlNiSVJhamRjODBPSnY2dUNVN053OFpIRkFOU2tQWm90TXc1RUNnWUVBNngrTmtLZXB6OXpMNHBjNzF6SEpcblhrSENPakUvYVZBRmgrSkxFbEx2d1AyRFZoc2ZUZG1IdWF1WVV4S0VaTjlRVnZMWHZ2RmdoMCtJNjNkMzdLTVNcbldjdHF6TzhGaVBBa3dRU21odml3VjVuTmRXQjJXNlVKY2lFYVVMdFBWTnB2REp6NFFEUnlHZ3l1K2FWbDZHQ3lcbmRYeWcwdHB3ajNsQU5XT2o2cGtCUytjPVxuLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLVxuIiwKICAiY2xpZW50X2VtYWlsIjogImZpcmViYXNlLWFkbWluc2RrLW5qazU1QHN2ZWNjaGEtMTFjMzEuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJjbGllbnRfaWQiOiAiMTAyMjgyODYzMzgwOTU4MDc2MDMwIiwKICAiYXV0aF91cmkiOiAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLAogICJ0b2tlbl91cmkiOiAiaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW4iLAogICJhdXRoX3Byb3ZpZGVyX3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YxL2NlcnRzIiwKICAiY2xpZW50X3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS9maXJlYmFzZS1hZG1pbnNkay1uams1NSU0MHN2ZWNjaGEtMTFjMzEuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJ1bml2ZXJzZV9kb21haW4iOiAiZ29vZ2xlYXBpcy5jb20iCn0K",
      "base64"
    ).toString("utf8")
  );

  admin.initializeApp({
    credential: admin.credential.cert(decodedServiceAccount),
    storageBucket: "sveccha-11c31.appspot.com",
    projectId: "sveccha-11c31",
  });
}

const storage = admin.storage().bucket();

module.exports = {
  admin,
  storage,
};

#!/bin/bash

# Colors for output
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo -e "${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${BLUE}â•‘      BANNER API - COMPREHENSIVE TEST SUITE                    â•‘${NC}"
echo -e "${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo ""

BASE_URL="http://localhost:5000"
ADMIN_TOKEN="YOUR_ADMIN_TOKEN_HERE"

# ==================== PUBLIC ENDPOINTS ====================

echo -e "${GREEN}ğŸ“‹ TEST 1: Get All Banners${NC}"
echo -e "${YELLOW}GET ${BASE_URL}/banner${NC}"
echo ""
curl -X GET "${BASE_URL}/banner" \
  -H "Content-Type: application/json" | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 2: Get Banners by Page (Home)${NC}"
echo -e "${YELLOW}GET ${BASE_URL}/banner/page/home${NC}"
echo ""
curl -X GET "${BASE_URL}/banner/page/home" \
  -H "Content-Type: application/json" | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 3: Get Banners by Page with Platform Filter (Mobile)${NC}"
echo -e "${YELLOW}GET ${BASE_URL}/banner/page/home?platform=mobile${NC}"
echo ""
curl -X GET "${BASE_URL}/banner/page/home?platform=mobile" \
  -H "Content-Type: application/json" | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 4: Get Banners by Page with Platform Filter (Web)${NC}"
echo -e "${YELLOW}GET ${BASE_URL}/banner/page/products?platform=web${NC}"
echo ""
curl -X GET "${BASE_URL}/banner/page/products?platform=web" \
  -H "Content-Type: application/json" | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

# ==================== ADMIN ENDPOINTS ====================

echo -e "${GREEN}ğŸ“‹ TEST 5: Create Banner for Web (Home Page)${NC}"
echo -e "${YELLOW}POST ${BASE_URL}/banner${NC}"
echo ""
curl -X POST "${BASE_URL}/banner" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${ADMIN_TOKEN}" \
  -d '{
    "name": "Summer Sale Web Banner",
    "title": "Summer Collection 2024",
    "subtitle": "Up to 50% Off",
    "description": "Get the best deals on summer fashion",
    "platform": "web",
    "page": "home",
    "actionType": "url",
    "actionUrl": "/products?category=summer",
    "displayOrder": 1,
    "isActive": true,
    "buttonText": "Shop Now",
    "buttonColor": "#FF6B6B",
    "textColor": "#FFFFFF",
    "tags": ["summer", "sale", "featured"],
    "webDesktopUrl": "https://example.com/banners/summer-desktop.jpg",
    "webTabletUrl": "https://example.com/banners/summer-tablet.jpg",
    "imageUrl": "https://example.com/banners/summer-desktop.jpg"
  }' | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 6: Create Banner for Mobile (Home Page)${NC}"
echo -e "${YELLOW}POST ${BASE_URL}/banner${NC}"
echo ""
curl -X POST "${BASE_URL}/banner" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${ADMIN_TOKEN}" \
  -d '{
    "name": "New Arrivals Mobile Banner",
    "title": "New Arrivals",
    "subtitle": "Fresh Styles Daily",
    "description": "Discover the latest fashion trends",
    "platform": "mobile",
    "page": "home",
    "actionType": "page",
    "actionValue": "products",
    "displayOrder": 2,
    "isActive": true,
    "buttonText": "Explore",
    "buttonColor": "#4ECDC4",
    "textColor": "#FFFFFF",
    "tags": ["new", "arrivals", "mobile"],
    "mobileUrl": "https://example.com/banners/new-arrivals-mobile.jpg",
    "imageUrl": "https://example.com/banners/new-arrivals-mobile.jpg"
  }' | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 7: Create Banner for Both Platforms (Products Page)${NC}"
echo -e "${YELLOW}POST ${BASE_URL}/banner${NC}"
echo ""
curl -X POST "${BASE_URL}/banner" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${ADMIN_TOKEN}" \
  -d '{
    "name": "Designer Spotlight Banner",
    "title": "Featured Designer",
    "subtitle": "Exclusive Collection",
    "description": "Shop exclusive designs from our featured designer",
    "platform": "both",
    "page": "designers",
    "actionType": "designer",
    "linkedDesigner": "DESIGNER_ID_HERE",
    "displayOrder": 1,
    "isActive": true,
    "buttonText": "View Collection",
    "buttonColor": "#2D3748",
    "textColor": "#FFFFFF",
    "tags": ["designer", "exclusive", "featured"],
    "webDesktopUrl": "https://example.com/banners/designer-desktop.jpg",
    "webTabletUrl": "https://example.com/banners/designer-tablet.jpg",
    "mobileUrl": "https://example.com/banners/designer-mobile.jpg",
    "imageUrl": "https://example.com/banners/designer-desktop.jpg"
  }' | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 8: Create Scheduled Banner${NC}"
echo -e "${YELLOW}POST ${BASE_URL}/banner${NC}"
echo ""
curl -X POST "${BASE_URL}/banner" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${ADMIN_TOKEN}" \
  -d '{
    "name": "Black Friday Sale Banner",
    "title": "Black Friday Mega Sale",
    "subtitle": "70% Off Everything",
    "description": "Biggest sale of the year",
    "platform": "both",
    "page": "home",
    "actionType": "url",
    "actionUrl": "/black-friday-deals",
    "displayOrder": 0,
    "isActive": true,
    "startDate": "2024-11-25T00:00:00Z",
    "endDate": "2024-11-30T23:59:59Z",
    "buttonText": "Shop Deals",
    "buttonColor": "#000000",
    "textColor": "#FFD700",
    "tags": ["black-friday", "sale", "limited-time"],
    "webDesktopUrl": "https://example.com/banners/black-friday-desktop.jpg",
    "mobileUrl": "https://example.com/banners/black-friday-mobile.jpg",
    "imageUrl": "https://example.com/banners/black-friday-desktop.jpg"
  }' | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 9: Create Product Linked Banner${NC}"
echo -e "${YELLOW}POST ${BASE_URL}/banner${NC}"
echo ""
curl -X POST "${BASE_URL}/banner" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${ADMIN_TOKEN}" \
  -d '{
    "name": "Featured Product Banner",
    "title": "Product of the Week",
    "subtitle": "Limited Stock Available",
    "description": "Trending designer dress - get it before it is gone",
    "platform": "both",
    "page": "products",
    "actionType": "product",
    "linkedProduct": "PRODUCT_ID_HERE",
    "displayOrder": 1,
    "isActive": true,
    "buttonText": "Buy Now",
    "buttonColor": "#E53E3E",
    "textColor": "#FFFFFF",
    "tags": ["product", "featured", "trending"],
    "webDesktopUrl": "https://example.com/banners/product-desktop.jpg",
    "mobileUrl": "https://example.com/banners/product-mobile.jpg",
    "imageUrl": "https://example.com/banners/product-desktop.jpg"
  }' | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 10: Get Single Banner by ID${NC}"
echo -e "${YELLOW}GET ${BASE_URL}/banner/BANNER_ID${NC}"
echo ""
# Replace BANNER_ID with actual ID from previous responses
# curl -X GET "${BASE_URL}/banner/BANNER_ID" \
#   -H "Content-Type: application/json" | jq '.'
echo "âš ï¸  Replace BANNER_ID with actual banner ID"
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 11: Update Banner${NC}"
echo -e "${YELLOW}PUT ${BASE_URL}/banner/BANNER_ID${NC}"
echo ""
curl -X PUT "${BASE_URL}/banner/BANNER_ID" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${ADMIN_TOKEN}" \
  -d '{
    "title": "Updated Banner Title",
    "subtitle": "Updated Subtitle",
    "buttonText": "Shop Updated",
    "isActive": true
  }' | jq '.'
echo "âš ï¸  Replace BANNER_ID with actual banner ID"
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 12: Toggle Banner Status${NC}"
echo -e "${YELLOW}PATCH ${BASE_URL}/banner/BANNER_ID/toggle${NC}"
echo ""
# curl -X PATCH "${BASE_URL}/banner/BANNER_ID/toggle" \
#   -H "Content-Type: application/json" \
#   -H "Authorization: Bearer ${ADMIN_TOKEN}" | jq '.'
echo "âš ï¸  Replace BANNER_ID with actual banner ID"
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 13: Track Banner Click${NC}"
echo -e "${YELLOW}POST ${BASE_URL}/banner/BANNER_ID/click${NC}"
echo ""
# curl -X POST "${BASE_URL}/banner/BANNER_ID/click" \
#   -H "Content-Type: application/json" | jq '.'
echo "âš ï¸  Replace BANNER_ID with actual banner ID"
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 14: Track Banner Impression${NC}"
echo -e "${YELLOW}POST ${BASE_URL}/banner/BANNER_ID/impression${NC}"
echo ""
# curl -X POST "${BASE_URL}/banner/BANNER_ID/impression" \
#   -H "Content-Type: application/json" | jq '.'
echo "âš ï¸  Replace BANNER_ID with actual banner ID"
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 15: Get Banner Analytics${NC}"
echo -e "${YELLOW}GET ${BASE_URL}/banner/BANNER_ID/analytics${NC}"
echo ""
# curl -X GET "${BASE_URL}/banner/BANNER_ID/analytics" \
#   -H "Content-Type: application/json" \
#   -H "Authorization: Bearer ${ADMIN_TOKEN}" | jq '.'
echo "âš ï¸  Replace BANNER_ID with actual banner ID"
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 16: Reorder Banners${NC}"
echo -e "${YELLOW}POST ${BASE_URL}/banner/reorder${NC}"
echo ""
curl -X POST "${BASE_URL}/banner/reorder" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ${ADMIN_TOKEN}" \
  -d '{
    "banners": [
      { "bannerId": "BANNER_ID_1", "displayOrder": 0 },
      { "bannerId": "BANNER_ID_2", "displayOrder": 1 },
      { "bannerId": "BANNER_ID_3", "displayOrder": 2 }
    ]
  }' | jq '.'
echo "âš ï¸  Replace BANNER_IDs with actual banner IDs"
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 17: Get Banners with Filters${NC}"
echo -e "${YELLOW}GET ${BASE_URL}/banner?page=home&platform=web&isActive=true&sortBy=displayOrder&sortOrder=asc${NC}"
echo ""
curl -X GET "${BASE_URL}/banner?page=home&platform=web&isActive=true&sortBy=displayOrder&sortOrder=asc" \
  -H "Content-Type: application/json" | jq '.'
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo -e "${GREEN}ğŸ“‹ TEST 18: Delete Banner${NC}"
echo -e "${YELLOW}DELETE ${BASE_URL}/banner/BANNER_ID${NC}"
echo ""
# curl -X DELETE "${BASE_URL}/banner/BANNER_ID" \
#   -H "Content-Type: application/json" \
#   -H "Authorization: Bearer ${ADMIN_TOKEN}" | jq '.'
echo "âš ï¸  Replace BANNER_ID with actual banner ID"
echo ""
echo "-------------------------------------------------------------------"
echo ""

echo ""
echo -e "${BLUE}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${BLUE}â•‘                    TEST SUITE COMPLETE                         â•‘${NC}"
echo -e "${BLUE}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""

echo -e "${YELLOW}ğŸ“š Banner API Features:${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Platform-specific banners (web/mobile/both)"
echo "âœ… Page-based banner organization"
echo "âœ… Responsive images (desktop/tablet/mobile)"
echo "âœ… Action linking (URL/Product/Category/Designer)"
echo "âœ… Display order management"
echo "âœ… Banner scheduling (start/end dates)"
echo "âœ… Active/Inactive status toggle"
echo "âœ… Analytics tracking (clicks/impressions)"
echo "âœ… Click-through rate calculation"
echo "âœ… Banner reordering"
echo "âœ… Customizable button colors and text"
echo "âœ… Tags for organization"
echo "âœ… Admin-only management"
echo "âœ… Public viewing endpoints"
echo ""

echo -e "${YELLOW}ğŸŒ Supported Pages:${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â€¢ home        - Homepage banners"
echo "â€¢ products    - Product listing page"
echo "â€¢ categories  - Category page"
echo "â€¢ designers   - Designer showcase"
echo "â€¢ about       - About us page"
echo "â€¢ contact     - Contact page"
echo "â€¢ checkout    - Checkout page"
echo "â€¢ profile     - User profile"
echo "â€¢ cart        - Shopping cart"
echo "â€¢ wishlist    - Wishlist page"
echo "â€¢ orders      - Order history"
echo "â€¢ custom      - Custom pages"
echo ""

echo -e "${YELLOW}ğŸ¯ Action Types:${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â€¢ none        - No action (display only)"
echo "â€¢ url         - External/internal URL"
echo "â€¢ product     - Link to specific product"
echo "â€¢ category    - Link to category"
echo "â€¢ designer    - Link to designer profile"
echo "â€¢ page        - Link to app page"
echo ""

echo -e "${YELLOW}ğŸ“± Platform Options:${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "â€¢ web         - Web platform only"
echo "â€¢ mobile      - Mobile app only"
echo "â€¢ both        - All platforms"
echo ""

echo -e "${YELLOW}ğŸ” Authentication:${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "Public Endpoints:"
echo "  â€¢ GET /banner"
echo "  â€¢ GET /banner/page/:pageName"
echo "  â€¢ GET /banner/:bannerId"
echo "  â€¢ POST /banner/:bannerId/click"
echo "  â€¢ POST /banner/:bannerId/impression"
echo ""
echo "Admin Only Endpoints:"
echo "  â€¢ POST /banner"
echo "  â€¢ PUT /banner/:bannerId"
echo "  â€¢ DELETE /banner/:bannerId"
echo "  â€¢ PATCH /banner/:bannerId/toggle"
echo "  â€¢ POST /banner/reorder"
echo "  â€¢ GET /banner/:bannerId/analytics"
echo ""

echo -e "${YELLOW}ğŸ’¡ Usage Tips:${NC}"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1. Set ADMIN_TOKEN variable before running admin operations"
echo "2. Replace placeholder IDs with actual values from responses"
echo "3. Use different images for web/tablet/mobile for better UX"
echo "4. Schedule banners in advance with startDate/endDate"
echo "5. Track analytics to measure banner effectiveness"
echo "6. Use displayOrder to control banner sequence"
echo "7. Link banners to products/categories for better conversion"
echo ""

